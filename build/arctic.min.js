(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());(function(h){function l(){try{if(arguments.length==1){console.log(arguments[0])}else{var z="";for(var x=0;x<arguments.length;x++){if(x!=0){z+=","}z+=arguments[x]}console.log(z)}}catch(y){}}function w(y,x){return function(){return y.apply(x,arguments)}}function p(z){var y=z.length,x=[];while(y--){x[y]=z[y]}return x}function f(A,E,D){if(arc.ua.isAndroid2_1){return[A,E]}var C=D*Math.PI/180;var B=A*Math.cos(C)-E*Math.sin(C);var z=A*Math.sin(C)+E*Math.cos(C);return[B,z]}function e(I,F,B,K,L){if(arc.ua.isAndroid2_1){return[I,F,B,K]}var J=f(I,F,L),H=f(I+B,F,L),G=f(I,F+K,L),E=f(I+B,F+K,L);var D=Math.min(J[0],H[0],G[0],E[0]),C=Math.min(J[1],H[1],G[1],E[1]),A=Math.max(J[0],H[0],G[0],E[0]),z=Math.max(J[1],H[1],G[1],E[1]);return[D,C,A-D,z-C]}function t(y){var A=y>>16;var z=y>>8&255;var x=y&255;return"rgb("+A+", "+z+", "+x+")"}var a={trace:l,bind:w,copyArray:p};var m={};m.isiPhone=/iPhone/i.test(navigator.userAgent);m.isiPhone4=(m.isiPhone&&window.devicePixelRatio==2);m.isiPad=/iPad/i.test(navigator.userAgent);m.isiOS=m.isiPhone||m.isiPad;m.isiOS3=(m.isiOS&&/OS\s3/.test(navigator.userAgent));m.isAndroid=/android/i.test(navigator.userAgent);m.isAndroid2_1=/android\s2\.1/i.test(navigator.userAgent);m.isMobile=m.isiOS||m.isAndroid;var u=320;var o=(function(){var x=function(){};function y(){var G=(typeof arguments[0]=="function")?arguments[0].prototype:{};if(!arguments[0]){throw new Error("define class")}function z(){this.initialize.apply(this,arguments)}function D(H){var I=H.toString().match(/^[\s\(]*function[^(]*\(([^)]*)\)/)[1].replace(/\/\/.*?[\r\n]|\/\*(?:.|[\r\n])*?\*\//g,"").replace(/\s+/g,"").split(",");return I.length==1&&!I[0]?[]:I}function F(J,H){var I=function(){var K=this;var M=(H!==undefined)?function(){return H.apply(K,arguments)}:undefined;var L=p(arguments);L.unshift(M);return J.apply(K,L)};I.valueOf=w(J.valueOf,J);I.toString=w(J.toString,J);return I}if(typeof arguments[0]=="function"){x.prototype=G;z.prototype=new x;Array.prototype.shift.apply(arguments)}var C=arguments[0];for(var E in C){var B=C[E];if(typeof B=="function"){if(D(B)[0]=="$super"){B=F(B,G[E])}else{if(E=="initialize"){if(G.initialize){var A=B;B=function(){G.initialize.apply(this,arguments);A.apply(this,arguments)}}}}}z.prototype[E]=B}z.prototype.constructor=z;return z}return{create:y}})();var v=o.create({type:null,target:null,_willPropagate:true,initialize:function(x,y){this.type=x;for(var z in y){if(y.hasOwnProperty(z)){if(z=="type"||z=="target"){continue}this[z]=y[z]}}},stopPropagation:function(){this._willPropagate=false},willPropagate:function(){return this._willPropagate}});v.PROGRESS="PROGRESS";v.COMPLETE="COMPLETE";v.ENTER_FRAME="ENTER_FRAME";v.ERROR="ERROR";v.TIMER="TIMER";v.TIMER_COMPLETE="TIMER_COMPLETE";v.TOUCH_START="TOUCH_START";v.TOUCH_MOVE="TOUCH_MOVE";v.TOUCH_END="TOUCH_END";var s=o.create({addEventListener:function(y,z){var x=s.listenHash[y];if(!x){x=s.listenHash[y]=[]}s.listenHash[y].push({target:this,callback:z})},removeEventListener:function(z,C){var x=s.listenHash[z];if(!x){return}var A=false;for(var y=0;y<x.length;y++){var B=x[y];if(B.target==this){if(C&&B.callback==C||!C){x.splice(y,1);A=true}}}if(x.length==0){delete s.listenHash[z];A=true}},dispatchEvent:function(){var B,E,D;if(arguments[0].constructor===String){B=arguments[0];E=arguments[1]}else{D=arguments[0];B=D.type}if(!s.listenHash[B]){return}var y=[];var A=s.listenHash[B];for(var z=0;z<A.length;z++){y[z]=A[z]}var x=y.length;for(var z=0;z<x;z++){var C=y[z];if(C.target==this){if(!D){D=new v(B,E)}D.target=this;C.callback.call(this,D)}}}});s.listenHash={};var j=o.create({_startTime:0,_isCounting:false,_elapsedTime:0,initialize:function(){},start:function(){this._isCounting=true;this._startTime=j.time},stop:function(){this._isCounting=false},reset:function(){this._isCounting=true;this._startTime=j.time},getElapsed:function(){if(this._isCounting){this._elapsedTime=j.time-this._startTime}return this._elapsedTime}});j.time=0;j.tick=function(){j.time=Date.now()};var g=o.create(s,{_timer:null,_currentCount:0,_repeatCount:0,_delay:0,_isRunning:false,_updateFunc:null,initialize:function(y,x){this._timer=new j();this._delay=y;this._repeatCount=(x)?x:0},reset:function(){this._currentCount=0;this.stop()},start:function(){this._timer.start();if(this._updateFunc){g.system.removeEventListener(v.ENTER_FRAME,this._updateFunc)}this._updateFunc=w(this._update,this);g.system.addEventListener(v.ENTER_FRAME,this._updateFunc)},_update:function(y){var x=this._timer.getElapsed();if(x>=this._delay){this._currentCount++;this._timer.reset();this.dispatchEvent(v.TIMER);if(this._repeatCount&&this._currentCount>=this._repeatCount){this.reset();this.dispatchEvent(v.TIMER_COMPLETE)}}},stop:function(){this._timer.stop();if(this._updateFunc){g.system.removeEventListener(v.ENTER_FRAME,this._updateFunc);this._updateFunc=null}},setDelay:function(x){this._delay=x},getDelay:function(){return this._delay},setRepeatCount:function(x){this._repeatCount=x},getRepeatCount:function(){return this._repeatCount}});g.system=null;var n=o.create(s,{_method:"GET",_params:null,_url:null,_request:null,_jsonResponse:null,_loadedCallBack:null,initialize:function(){this._request=new XMLHttpRequest();this._loadedCallBack=w(this._loaded,this)},load:function(x,y){this._url=x;this._params=y;this._request.open(this._method,this._url,true);this._request.addEventListener("readystatechange",this._loadedCallBack,false);this._request.send(this._params)},_loaded:function(){if(this._request.readyState==4){if(this._request.status==200||this._request.status==0){this.dispatchEvent(v.COMPLETE)}else{this.dispatchEvent(v.ERROR);throw new Error("Load Error : "+this._url)}}},unload:function(){this._request.abort();this._jsonResponse=null;this._request.removeEventListener("readystatechange",this._loadedCallBack,false)},setMethod:function(x){this._method=x},getResponseText:function(){return this._request.responseText},getResponseJSON:function(){if(!this._jsonResponse){this._jsonResponse=JSON.parse(this._request.responseText)}return this._jsonResponse},getURL:function(){return this._url}});function q(){if(window.orientation==90||window.orientation==-90){return screen.height}else{return screen.width}}var k={};k.Image=o.create(s,{_data:null,_path:null,_width:null,_height:null,_frameWidth:null,_lx:null,_ly:null,_lwidth:null,_lheight:null,_hasLocalPos:false,initialize:function(x,y){if(!x&&x.constructor!=HTMLImageElement){throw new Error("set HTMLImageElement")}this._data=x;this._path=x.src;if(y&&y.length==4){this._lx=y[0];this._ly=y[1];this._lwidth=y[2];this._lheight=y[3];this._hasLocalPos=true;this._width=this._lwidth;this._height=this._lheight}else{this._width=this._data.width;this._height=this._data.height}},duplicate:function(){var x=new k.Image();x._setData(this._data);return x},changeScale:function(y,x){return this.changeSize(this._width*y,this._height*x)},changeSize:function(E,B){var C=document.createElement("canvas"),A=0,G=0,D=this._width,z=this._height;C.width=E;C.height=B;if(this._hasLocalPos){A=this._lx;G=this._ly;D=this._lwidth;z=this._lheight;this._hasLocalPos=false}if(arc.ua.isAndroid2_1&&q()!=u){var F=u/q();A=~~(A*F);G=~~(G*F);D=~~(D*F);z=~~(z*F);E=~~(E*F);B=~~(B*F)}C.getContext("2d").drawImage(this._data,A,G,D,z,0,0,E,B);this._data=C;this._width=this._data.width;this._height=this._data.height;return this},changeColor:function(J,C){var H=this._data.width;var G=this._data.height;var y=document.createElement("canvas");y.width=H;y.height=G;var I=y.getContext("2d");I.drawImage(this._data,0,0);var D=I.getImageData(0,0,H,G);var B=I.createImageData(H,G);var A=J>>16;var E=J>>8&255;var x=J&255;for(var L=0;L<G;L++){for(var K=0;K<H;K++){var z=K*4+L*4*H;var F=(A-D.data[z])*C+D.data[z];var N=(E-D.data[z+1])*C+D.data[z+1];var M=(x-D.data[z+2])*C+D.data[z+2];var O=D.data[z+3];B.data[z]=(F*O/255)|0;B.data[z+1]=(N*O/255)|0;B.data[z+2]=(M*O/255)|0;B.data[z+3]=O}}I.putImageData(B,0,0);this._data=y;return this},draw:function(z,D,B){if(this._hasLocalPos){this.drawCrop(this._lx,this._ly,this._lwidth,this._lheight,z,D,this._width,this._height,B);return}if(arc.ua.isAndroid2_1&&q()!=u){var C=u/q();z*=C;D*=C}z=~~(z);D=~~(D);var A=k.Image.context;A.save();A.translate(z,D);if(B%360!=0){A.rotate(B)}A.drawImage(this._data,0,0);A.restore()},drawSize:function(C,B,z,F,G){if(this._hasLocalPos){this.drawCrop(this._lx,this._ly,this._lwidth,this._lheight,C,B,z,F,G);return}var E=z/this._width;var D=F/this._height;var H=k.Image.context;if(arc.ua.isAndroid2_1){var A=u/q();C=~~(C*A);B=~~(B*A);z=~~(z*A);F=~~(F*A);H.drawImage(this._data,C,B,z,F);return}C=~~(C);B=~~(B);z=~~(z);F=~~(F);H.save();H.translate(C,B);if(G%360!=0){H.rotate(G*Math.PI/180)}if(E!=1||D!=1){H.scale(E,D)}H.drawImage(this._data,0,0,this._width,this._height);H.restore()},drawCrop:function(A,G,B,E,x,F,z,D,K){if(this._hasLocalPos&&this._frameWidth){A+=this._lx;G+=this._ly}var y=(this._frameWidth)?this._frameWidth:this._width;var I=z/y;var H=D/this._height;var J=k.Image.context;if(arc.ua.isAndroid2_1){var C=u/q();if(this._data.constructor!=HTMLCanvasElement){A=~~(A*C);G=~~(G*C);B=~~(B*C);E=~~(E*C)}x=~~(x*C);F=~~(F*C);z=~~(z*C);D=~~(D*C);J.drawImage(this._data,A,G,B,E,x,F,z,D);return}A=~~(A);G=~~(G);B=~~(B);E=~~(E);x=~~(x);F=~~(F);z=~~(z);D=~~(D);J.save();J.translate(x,F);if(K%360!=0){J.rotate(K*Math.PI/180)}if(I!=1||H!=1){J.scale(I,H)}J.drawImage(this._data,A,G,B,E,0,0,y,this._height);J.restore()},setFrameWidth:function(x){this._frameWidth=x},getFrameWidth:function(){return this._frameWidth},getWidth:function(){return this._width},getHeight:function(){return this._height},getPath:function(){return this._path}});k.Image.context=null;k.DisplayObject=o.create(s,{_data:null,_parent:null,_x:0,_y:0,_width:null,_height:null,_visible:true,_scaleX:1,_scaleY:1,_alpha:1,_rotation:0,_alignX:0,_alignY:0,_screenRect:[],initialize:function(x){if(!x){return}this._data=x;this._width=this._data.getWidth();this._height=this._data.getHeight();this._screenRect=[0,0,this._width,this._height]},localToGlobal:function(B,G){var D=this,A=B,F=G;var C=0,z=0;while(D){var E=f(A,F,D.getRotation());C+=E[0];z+=E[1];A=D.getX();F=D.getY();D=D.getParent()}return[C,z]},globalToLocal:function(I,F){var B=[];var D=this,L=I,K=F,G=I,C=F;while(D){B.unshift(D);D=D.getParent()}for(var A=0;A<B.length;A++){var z=B[A];G-=z.getX();C-=z.getY();var E=f(G,C,-1*z.getRotation());var J=E[0];var H=E[1];G=J;C=H}return[G,C]},hitTestObject:function(x){},draw:function(){},setX:function(x){this._x=x;this._updateScreenRect()},getX:function(){return this._x},setY:function(x){this._y=x;this._updateScreenRect()},getY:function(){return this._y},setWidth:function(x){if(!x){x=0}this._width=x;if(this._data){this._scaleX=this._width/this._data.getWidth()}this._updateScreenRect()},getWidth:function(){return this._width},setHeight:function(x){if(!x){x=0}this._height=x;if(this._data){this._scaleY=this._height/this._data.getHeight()}this._updateScreenRect()},getHeight:function(){return this._height},setScaleX:function(x){if(!x){x=0}this._scaleX=x;this._width=this._data.getWidth()*this._scaleX;this._updateScreenRect()},getScaleX:function(){return this._scaleX},setScaleY:function(x){if(!x){x=0}this._scaleY=x;this._height=this._data.getHeight()*this._scaleY;this._updateScreenRect()},getScaleY:function(){return this._scaleY},setVisible:function(x){this._visible=x},getVisible:function(){return this._visible},getParent:function(){return this._parent},setAlpha:function(x){if(!x){x=0}this._alpha=x},getAlpha:function(){return this._alpha},setRotation:function(x){if(!x){x=0}this._rotation=x},getRotation:function(){return this._rotation},getAlignX:function(){return this._alignX},getAlignY:function(){return this._alignY},getStage:function(){return k.Stage.instance},_updateScreenRect:function(){var x=this._x+this._alignX*this._scaleX,A=this._y+this._alignY*this._scaleY,z=this._width,y=this._height;this._screenRect=e(x,A,z,y,this._rotation)}});k.DisplayObjectContainer=o.create(k.DisplayObject,{_displayArr:null,_originWidth:0,_originHeight:0,_maskObj:null,initialize:function($super){$super(null);this._displayArr=[];this._minX=this._maxX=this._minY=this._maxY=0},addChild:function(z){var x=this._displayArr.length;for(var y=0;y<x;y++){if(this._displayArr[y]==z){return}}this._displayArr.push(z);z._parent=this;this._updateSize()},addChildAt:function(y,x){this._displayArr.splice(x,0,y);y._parent=this;this._updateSize()},removeChild:function(z){var x=this._displayArr.length;for(var y=0;y<x;y++){if(this._displayArr[y]==z){this._displayArr.splice(y,1);z._parent=null;if(z._removeAllChild){z._removeAllChild()}break}}this._updateSize()},_removeAllChild:function(){var z,x,y;for(z=0,x=this._displayArr.length;z<x;z++){y=this._displayArr[z];y._parent=null;if(y._removeAllChild){y._removeAllChild()}}this._displayArr=[]},contains:function(z){var x=this._displayArr.length;for(var y=0;y<x;y++){if(this._displayArr[y]==z){return true}}return false},setChildIndex:function(B,z){for(var A=0,x=this._displayArr.length;A<x;A++){var y=this._displayArr[A];if(y==B){this._displayArr.splice(A,1);this._displayArr.splice(z,0,B)}}},draw:function(B,A,J,I,z,H){if(!this.getVisible()){return}B=(B|0);A=(A|0);J=(!isNaN(J))?J:1;I=(!isNaN(I))?I:1;z=(!isNaN(z))?z:1;H=(H)?H:0;var S=B;var R=A;var F=J*this._scaleX;var D=I*this._scaleY;var L=z*this._alpha;var T=H+this._rotation;var y=k.Image.context;var Q=p(this._displayArr);var N=Q.length;for(var M=0;M<N;M++){var K=Q[M];var G=K.getX()*F;var E=K.getY()*D;if(T%360!=0){var P=G;var O=E;var C=f(P,O,T);G=C[0];E=C[1]}var x=K.getAlignX()*F*K.getScaleX();var U=K.getAlignY()*D*K.getScaleY();var C=f(x,U,(K.getRotation()+T));G+=C[0]+S;E+=C[1]+R;if(!K.getVisible()){continue}if(this._maskObj){y.save();y.beginPath();y.rect(this._maskObj.x*F+S,this._maskObj.y*D+R,this._maskObj.width*F,this._maskObj.height*D);y.closePath();y.clip()}K.draw(G,E,F,D,L,T);if(this._maskObj){y.restore()}}this._updateSize()},_updateSize:function(){var C=0,B=0,y=0,x=0;var E=this._displayArr.length;for(var D=0;D<E;D++){var F=this._displayArr[D];var A=F._screenRect[0],z=F._screenRect[1],H=F._screenRect[0]+F._screenRect[2],G=F._screenRect[1]+F._screenRect[3];if(D==0){C=A;B=z;y=H;x=G}if(A<C){C=A}if(H>y){y=H}if(z<B){B=z}if(G>x){x=G}}this._originWidth=y-C;this._originHeight=x-B;this._width=this._originWidth*this._scaleX;this._height=this._originHeight*this._scaleY;this._screenRect=e(C*this._scaleX+this._x,B*this._scaleY+this._y,this._width,this._height,this._rotation)},setWidth:function(x){this._width=x;this._scaleX=this._width/this._originWidth},setHeight:function(x){this._height=x;this._scaleY=this._height/this._originHeight},setScaleX:function(x){this._scaleX=x;this._width=this._originWidth*this._scaleX},setScaleY:function(x){this._scaleY=x;this._height=this._originHeight*this._scaleY},setMask:function(A,C,B,z){this._maskObj={x:A,y:C,width:B,height:z}},clearMask:function(){this._maskObj=null},_updateScreenRect:function(){this._updateSize()}});k.Align={TOP:"TOP",TOP_LEFT:"TOP_LEFT",TOP_RIGHT:"TOP_RIGHT",CENTER:"CENTER",LEFT:"LEFT",RIGHT:"RIGHT",BOTTOM:"BOTTOM",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_RIGHT:"BOTTOM_RIGHT"};k.Shape=o.create(k.DisplayObject,{_funcStack:null,_minX:0,_maxX:0,_minY:0,_maxY:0,_firstFlg:true,_willBeFilled:false,_willBeStroked:false,initialize:function(){this._funcStack=new Array()},beginFill:function(y,z){var x=this;this._funcStack.push(function(D,B,F,E,C){x._willBeFilled=true;var A=k.Image.context;A.fillStyle=t(y);A.globalAlpha=z*C})},endFill:function(){var x=this;this._funcStack.push(function(B,z,D,C,A){x._willBeFilled=false;var y=k.Image.context})},beginStroke:function(z,y,A){var x=this;if(!A){A=1}this._funcStack.push(function(E,C,G,F,D){x._willBeStroked=true;var B=k.Image.context;B.lineWidth=z;B.strokeStyle=t(y);B.globalAlpha=A*D})},endStroke:function(){var x=this;this._funcStack.push(function(A,y,C,B,z){x._willBeStroked=false})},moveTo:function(z,A){this._funcStack.push(function(C,y,E,D,B){var x=k.Image.context;x.moveTo((z+C)/E,(A+y)/D)})},lineTo:function(z,B){var A=this;this._funcStack.push(function(D,y,F,E,C){var x=k.Image.context;x.lineTo((z+D)/F,(B+y)/E);if(A._willBeStroked){x.stroke()}})},_updateSize:function(A,C,B,z){if(this._firstFlg){this._firstFlg=false;this._minX=A;this._maxX=A+B;this._minY=C;this._maxY=C+z}if(A<this._minX){this._minX=A}if(A+B>this._maxX){this._maxX=A+B}if(C<this._minY){this._minY=C}if(C+z>this._maxY){this._maxY=C+z}this._originWidth=this._maxX-this._minX;this._originHeight=this._maxY-this._minY;this._width=this._originWidth*this._scaleX;this._height=this._originHeight*this._scaleY;this._updateScreenRect()},drawRect:function(A,D,C,z){this._updateSize(A,D,C,z);var B=this;this._funcStack.push(function(F,y,H,G,E){var x=k.Image.context;x.beginPath();x.rect((A+F)/H,(D+y)/G,C,z);if(B._willBeFilled){x.fill()}if(B._willBeStroked){x.stroke()}})},drawCircle:function(A,C,z){this._updateSize(A-z,C-z,z*2,z*2);var B=this;this._funcStack.push(function(E,y,G,F,D){var x=k.Image.context;x.beginPath();x.arc((A+E)/G,(C+y)/F,z,0,360,false);if(B._willBeFilled){x.fill()}if(B._willBeStroked){x.stroke()}})},draw:function(C,A,K,J,F,B){C=(C|0);A=(A|0);K=(!isNaN(K))?K:1;J=(!isNaN(J))?J:1;F=(!isNaN(F))?F:1;B=(B)?B:0;var L=C;var I=A;var z=K*this._scaleX;var y=J*this._scaleY;var H=F*this._alpha;var x=B+this._rotation;var G=this._funcStack.length;var M=k.Image.context;M.save();M.scale(z,y);for(var E=0;E<G;E++){var D=this._funcStack[E];D.call(this,L,I,z,y,H,x)}M.restore()},setWidth:function(x){this._width=x;this._scaleX=this._width/this._originWidth;this._updateScreenRect()},getWidth:function(){return this._width*this._scaleX},setHeight:function(x){this._height=x;this._scaleY=this._height/this._originHeight;this._updateScreenRect()},getHeight:function(){return this._height*this._scaleY},setScaleX:function(x){this._scaleX=x;this._width=this._originWidth*this._scaleX;this._updateScreenRect()},setScaleY:function(x){this._scaleY=x;this._height=this._originHeight*this._scaleY;this._updateScreenRect()},_updateScreenRect:function(){var x=this._x+this._minX*this._scaleX,A=this._y+this._minY*this._scaleY,z=this._width,y=this._height;this._screenRect=e(x,A,z,y,this._rotation)}});k.ImageContainer=o.create(k.DisplayObject,{_align:k.Align.TOP_LEFT,_alignX:0,_alignY:0,initialize:function(x){},setAlign:function(y){var x=(this._data.getFrameWidth())?this._data.getFrameWidth():this._data.getWidth();switch(y){case k.Align.TOP:this._alignX=-1*x/2;this._alignY=0;break;case k.Align.TOP_LEFT:this._alignX=0;this._alignY=0;break;case k.Align.TOP_RIGHT:this._alignX=-1*x;this._alignY=0;break;case k.Align.CENTER:this._alignX=-1*x/2;this._alignY=-1*this._data.getHeight()/2;break;case k.Align.LEFT:this._alignX=0;this._alignY=-1*this._data.getHeight()/2;break;case k.Align.RIGHT:this._alignX=-1*x;this._alignY=-1*this._data.getHeight()/2;break;case k.Align.BOTTOM:this._alignX=-1*x/2;this._alignY=-1*this._data.getHeight();break;case k.Align.BOTTOM_LEFT:this._alignX=0;this._alignY=-1*this._data.getHeight();break;case k.Align.BOTTOM_RIGHT:this._alignX=-1*x;this._alignY=-1*this._data.getHeight();break;default:throw new Error("Specify align");break}this._align=y},getAlign:function(){return this._align}});k.Sprite=o.create(k.ImageContainer,{initialize:function(x){},draw:function(B,z,E,D,C,A){B=(B|0);z=(z|0);E=(!isNaN(E))?E:1;D=(!isNaN(D))?D:1;C=(!isNaN(C))?C:1;A=(A)?A:0;var G=this._rotation+A;var y=this._scaleX*E;var x=this._scaleY*D;var F=k.Image.context;F.globalAlpha=this._alpha*C;this._data.drawSize(B,z,this._width*E,this._height*D,G);F.globalAlpha=1}});k.MovieClip=o.create(k.DisplayObjectContainer,{_shouldLoop:false,_fps:0,_timer:null,_currentFrame:0,_isPlaying:false,_isShowed:false,_timelineArr:null,_totalFrame:0,_shouldAutoPlay:false,initialize:function(z,y,x){this._fps=z;this._shouldLoop=(y);this._timer=new j();this._currentFrame=1;this._timelineArr=[];this._totalFrame=0;this._shouldAutoPlay=(x==undefined)?true:(x)},draw:function($super,z,x,C,B,y,A){if(!this._isShowed&&this._shouldAutoPlay){this._isShowed=true;this.play()}if(this._isPlaying){this._update()}$super(z,x,C,B,y,A)},_update:function(){var x=this._timer.getElapsed();var A=1000/this._fps;if(x>=A){this._step();x=this._timer.getElapsed()}for(var y=0;y<this._timelineArr.length;y++){var z=this._timelineArr[y];z.update(this._currentFrame,x)}},_step:function(){var x,y;this._timer.reset();this._currentFrame++;this._executeKeyFrame(this._currentFrame);if(this._currentFrame==this._totalFrame){if(!this._shouldLoop){this.stop();return}this._currentFrame=0}},_executeKeyFrame:function(y){var A,B;for(var z=0,x=this._timelineArr.length;z<x;z++){A=this._timelineArr[z];B=A.getTarget();if(y==A.getFirstFrame()&&B.gotoAndPlay){B.gotoAndPlay(1)}A.executeKeyFrame(y)}},removeChild:function($super,z){$super(z);this._isPlaying=false;this._timer.stop();for(var y=0,x=this._timelineArr.length;y<x;y++){var A=this._timelineArr[y];if(A.getTarget()===z){this._timelineArr.splice(y,1);break}}},_setTimeline:function(x,y){timeline=new i.Timeline(x,y,this._fps);this._timelineArr.push(timeline);totalFrame=timeline.getTotalFrames();if(this._totalFrame<totalFrame){this._totalFrame=totalFrame}},addChild:function($super,y,A){var z,x;$super(y);if(A){this._setTimeline(y,A)}},addChildAt:function($super,z,x,B){var A,y;$super(z,x);if(B){this._setTimeline(z,B)}},play:function(){this._isPlaying=true;this._timer.start();this._executeKeyFrame(this._currentFrame)},stop:function(){this._isPlaying=false;this._timer.stop()},gotoAndPlay:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.play()},gotoAndStop:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.stop()}});k.JSONMovieClip=o.create(k.MovieClip,{initialize:function($super,D){var x=arc.display.Sprite,C=arc.System,E=arc.display.MovieClip;var F=D.lib,B=D.fps,y=A(D.main);$super(B);function z(N,I){var J,L,H,G,K,M,I;L=A(N);if(!L){throw new Error("invalid animation")}if(L.type=="data"){if(L.pos){return new x(arc._system.getImage(L.data,L.pos))}else{return new x(arc._system.getImage(L.data))}}if(!I){I=new E(B,L.loop)}for(J=0,G=L.timelines.length;J<G;J++){K=L.timelines[J];M=z(K.target);if((M.constructor===x)&&K.align){M.setAlign(K.align)}I.addChildAt(M,0,K.keyframes)}return I}function A(J){var H,G,I;for(H=0,G=F.length;H<G;H++){I=F[H];if(I.id==J){break}}return I}this._shouldLoop=(y.loop);z(D.main,this)}});k.SheetMovieClip=o.create(k.ImageContainer,{_currentFrame:1,_totalFrame:1,_frameWidth:0,_frameTime:0,_isPlaying:false,_timer:null,_shouldLoop:false,_shouldHide:false,initialize:function(A,y,B,x,z){this._timer=new j();this._frameWidth=y;this._totalFrame=Math.floor(this._data.getWidth()/y);this._width=y;this._frameTime=1000/B;this._shouldLoop=x;this._shouldHide=z;this._data.setFrameWidth(this._frameWidth);if(this._shouldHide){this._visible=false}this.stop()},play:function(x){this._isPlaying=true;if(x!=undefined){this._shouldLoop=x}if(this._shouldHide&&!this._visible){this._visible=true}this._timer.start()},stop:function(){this._isPlaying=false;this._timer.stop();if(this._shouldHide){this._visible=false}},gotoAndPlay:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.play()},gotoAndStop:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.stop()},draw:function(E,C,H,G,F,D){E=(E|0);C=(C|0);H=(!isNaN(H))?H:1;G=(!isNaN(G))?G:1;F=(!isNaN(F))?F:1;D=(D)?D:0;if(!this._visible){return}if(this._isPlaying){var I=this._timer.getElapsed();if(I>=this._frameTime){this._currentFrame++;this._timer.reset();if(this._currentFrame>this._totalFrame){if(this._shouldLoop){this._currentFrame=this._currentFrame%this._totalFrame}else{this._currentFrame=this._totalFrame;this.stop();this.dispatchEvent(v.COMPLETE)}}}}var B=(this._x+this._alignX*this._scaleX)*H+E;var z=(this._y+this._alignY*this._scaleY)*G+C;var A=this._scaleX*H;var y=this._scaleY*G;var x=this._rotation+D;var J=k.Image.context;J.globalAlpha=this._alpha;this._data.drawCrop((this._currentFrame-1)*this._frameWidth,0,this._frameWidth,this._data.getHeight(),E,C,this._width*H,this._height*G,x);J.globalAlpha=1},setWidth:function(x){this._width=x;this._scaleX=this._width/this._frameWidth},setScaleX:function(x){this._scaleX=x;this._width=this._frameWidth*this._scaleX}});k.SequenceMovieClip=o.create(k.DisplayObjectContainer,{_spriteArr:null,_frameTime:0,_shouldLoop:false,_shouldHide:false,_isPlaying:false,_totalFrame:0,_currentIndex:0,_timer:null,initialize:function(D,C,y,z){var B=0,x=D.length,A;this._spriteArr=[];this._frameTime=C;this._shouldLoop=y;this._shouldHide=z;this._totalFrame=D.length;this._timer=new j();for(B=0;B<x;B++){A=new k.Sprite(D[B]);A.setVisible(false);this._spriteArr.push(A);this.addChild(A)}if(z){this._visible=false}},draw:function($super,z,x,F,E,B,y){$super(z,x,F,E,B,y);var A,D=this._spriteArr.length,G;if(this._isPlaying){var C=Math.floor(this._timer.getElapsed()/this._frameTime);if(C>this._totalFrame-1){if(this._shouldLoop){C=C%this._totalFrame}else{C=this._totalFrame;this.stop();this.dispatchEvent(v.COMPLETE)}}this._currentFrame=C}for(A=0;A<D;A++){G=this._spriteArr[A];if(A==this._currentFrame){G.setVisible(true)}else{G.setVisible(false)}}},play:function(x){this._isPlaying=true;if(x){this._shouldLoop=x}if(this._shouldHide&&!this._visible){this._visible=true}this._timer.start()},stop:function(){this._isPlaying=false;this._timer.stop();if(this._shouldHide){this._visible=false}},gotoAndPlay:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.play()},gotoAndStop:function(x){if(x<1||x>this._totalFrame){throw new Error("Invalid frame index")}this._currentFrame=x;this.stop()}});k.Stage=o.create(k.DisplayObjectContainer,{initialize:function(y,x){if(k.Stage.instance){return k.Stage.instance}k.Stage.instance=this;this._stageWidth=y;this._stageHeight=x},getStageWidth:function(){return this._stageWidth},getStageHeight:function(){return this._stageHeight}});k.Stage.instance=null;k.TextField=o.create(k.DisplayObject,{_font:null,_family:"sans-serif",_textArr:null,_color:0,_align:"left",_baseline:"top",_size:10,initialize:function(){if(m.isiOS3){throw new Error("Your can't use TextField in iOS3")}this._font=this._size+"px "+this._family;this._textArr=[]},draw:function(C,A,H,G,E,B){C=(C|0);A=(A|0);H=(!isNaN(H))?H:1;G=(!isNaN(G))?G:1;E=(!isNaN(E))?E:1;B=(B)?B:0;var K=this._rotation+B;var z=this._scaleX*H;var y=this._scaleY*G;var J=k.Image.context;J.globalAlpha=this._alpha*E;J.save();J.fillStyle=t(this._color);J.textBaseline="top";J.font=this._font;J.textAlign=this._align;J.textBaseline=this._baseline;var x=A;for(var D=0,F=this._textArr.length;D<F;D++){var I=this._textArr[D];J.fillText(I,C,x);x+=this._size}J.restore();J.globalAlpha=1},setAlign:function(x){switch(x){case k.Align.TOP:this._align="center";this._baseline="top";break;case k.Align.TOP_LEFT:this._align="left";this._baseline="top";break;case k.Align.TOP_RIGHT:this._align="right";this._baseline="top";break;case k.Align.CENTER:this._align="center";this._baseline="middle";break;case k.Align.LEFT:this._align="left";this._baseline="middle";break;case k.Align.RIGHT:this._align="right";this._baseline="middle";break;case k.Align.BOTTOM:this._align="center";this._baseline="bottom";break;case k.Align.BOTTOM_LEFT:this._align="left";this._baseline="bottom";break;case k.Align.BOTTOM_RIGHT:this._align="right";this._baseline="bottom";break;default:throw new Error("Specify align");break}},setText:function(x){if(!(x instanceof String)){x=String(x)}this._textArr=x.split("\n");if(this._width){this._adjustWidth()}},_adjustWidth:function(){var y=k.Image.context;y.font=this._font;for(var A=0;A<this._textArr.length;A++){var D=this._textArr[A];var B=y.measureText(D);if(B.width<=this._width){continue}for(var z=0,x=D.length;z<x;z++){var C=D.substr(0,z+1);B=y.measureText(C);if(B.width>this._width){this._textArr[A]=D.substr(0,z);this._textArr.splice(A+1,0,D.substr(z));break}}}},setFont:function(z,x,y){this._family=z;this._size=x;this._font=x+"px "+z;if(y){this._font="bold "+this._font}if(this._textArr.length&&this._width){this._adjustWidth()}},setColor:function(x){this._color=x}});var i={};i.Animation=o.create(s,{_timer:null,_target:null,_system:null,_animObjArr:null,_shouldReplay:false,_isPlaying:false,_currentIndex:0,_currentAnim:null,_currentTransFunc:null,_firstParams:null,_currentDuration:null,_updateFunc:null,_HALF_PI:Math.PI/2,initialize:function(y){if(!y){throw new Error("Specify target")}if(arguments.length<2){throw new Error("Specify Animaiton Objects")}this._target=y;this._timer=new j();this._animObjArr=new Array();for(var x=1;x<arguments.length;x++){this._animObjArr.push(arguments[x])}},play:function(x){if(this._isPlaying){return}var y=i.Animation.system;this._isPlaying=true;this._shouldReplay=(x);this._timer.start();this._currentIndex=-1;if(this._changeAnim()){if(this._updateFunc){y.removeEventListener(v.ENTER_FRAME,this._updateFunc)}this._updateFunc=w(this._update,this);y.addEventListener(v.ENTER_FRAME,this._updateFunc)}},stop:function(){if(!this._isPlaying){return}var x=i.Animation.system;this._isPlaying=false;if(this._updateFunc){x.removeEventListener(v.ENTER_FRAME,this._updateFunc);this._updateFunc=null}this.dispatchEvent(v.COMPLETE)},_changeAnim:function(){this._currentIndex++;if(this._currentIndex>=this._animObjArr.length){if(!this._shouldReplay){this.stop();return false}else{this._currentIndex=0}}this._timer.reset();var x=this._animObjArr[this._currentIndex];this._currentAnim={};this._firstParams={};for(var y in x){if(y=="time"||y=="transition"){continue}this._currentAnim[y]=x[y];this._firstParams[y]=this._getProperty(this._target,y)}this._currentDuration=(x.time==undefined)?1000:x.time;this._currentTransFunc=i.Transition.getTransFunc(x.transition);return true},_getProperty:function(y,z){z.match(/^([a-z])(.*)/);var x="get"+RegExp.$1.toUpperCase()+RegExp.$2;if(y[x]){return y[x]()}return undefined},_setProperty:function(z,A,x){A.match(/^([a-z])(.*)/);var y="set"+RegExp.$1.toUpperCase()+RegExp.$2;if(z[y]){z[y](x)}},_update:function(){var x=this._timer.getElapsed();var y=this._currentTransFunc(x/this._currentDuration);if(x>=this._currentDuration){for(var A in this._currentAnim){this._setProperty(this._target,A,this._currentAnim[A])}if(this._changeAnim()){this._update()}return}for(var A in this._currentAnim){var z=(this._currentAnim[A]-this._firstParams[A])*y+this._firstParams[A];if(A=="visible"){z=this._firstParams[A]}this._setProperty(this._target,A,z)}},isPlaying:function(){return this._isPlaying}});i.Animation.system=null;(function(x){var E={SINE_IN:"SINE_IN",SINE_OUT:"SINE_OUT",SINE_INOUT:"SINE_INOUT",LINEAR:"LINEAR",CIRC_IN:"CIRC_IN",CIRC_OUT:"CIRC_OUT",CIRC_INOUT:"CIRC_INOUT",CUBIC_IN:"CUBIC_IN",CUBIC_OUT:"CUBIC_OUT",CUBIC_INOUT:"CIRC_INOUT",ELASTIC_IN:"ELASTIC_IN",ELASTIC_OUT:"ELASTIC_OUT",ELASTIC_INOUT:"ELASTIC_INOUT",getTransFunc:B};var H=Math.PI/2;function B(O){switch(O){case E.LINEAR:return y;case E.SINE_IN:return J;case E.SINE_OUT:return M;case E.SINE_INOUT:return F;case E.CIRC_IN:return D;case E.CIRC_OUT:return C;case E.CIRC_INOUT:return z;case E.CUBIC_IN:return N;case E.CUBIC_OUT:return K;case E.CUBIC_INOUT:return L;case E.ELASTIC_IN:return G;case E.ELASTIC_OUT:return I;case E.ELASTIC_INOUT:return A;default:return y}}function y(O){return O}function J(O){return 1-Math.cos(O*H)}function M(O){return 1-J(1-O)}function F(O){return(O<0.5)?J(O*2)*0.5:1-J(2-O*2)*0.5}function D(O){return 1-Math.sqrt(1-O*O)}function C(O){return 1-D(1-O)}function z(O){return(O<0.5)?D(O*2)*0.5:1-D(2-O*2)*0.5}function N(O){return O*O*O}function K(O){return 1-N(1-O)}function L(O){return(O<0.5)?N(O*2)*0.5:1-N(2-O*2)*0.5}function G(O){return 1-I(1-O)}function I(O){var P=1-O;return 1-Math.pow(P,8)+Math.sin(O*O*6*Math.PI)*P*P}function A(O){return(O<0.5)?G(O*2)*0.5:1-G(2-O*2)*0.5}x.Transition=E})(i);i.Timeline=o.create({_target:null,_keyFrameObj:null,_totalFrame:0,_fps:0,_baseFrame:null,_firstFrame:0,initialize:function(A,B,z){var x;this._target=A;this._keyFrameObj=B;if(z){this._fps=z}for(var D in this._keyFrameObj){var C=B[D];var y=parseInt(D,10);if(this._firstFrame==0||this._firstFrame>y){this._firstFrame=y}C.index=D;x=parseInt(D,10);if(this._totalFrame<x){this._totalFrame=x}}},update:function(z,x){if(!this._baseFrame||!this._baseFrame.transition||!this._baseFrame.nextFrame){return}x+=(z-this._baseFrame.index)*1000/this._fps;var B=(this._baseFrame.nextFrame.index-this._baseFrame.index)*1000/this._fps;var y=i.Transition.getTransFunc(this._baseFrame.transition)(x/B);for(var C in this._baseFrame){if(C=="transition"||C=="action"||C=="index"||C=="nextFrame"||this._baseFrame.nextFrame[C]==undefined){continue}var A=(this._baseFrame.nextFrame[C]-this._baseFrame[C])*y+this._baseFrame[C];if(C=="visible"){A=this._baseFrame[C]}this._setProperty(this._target,C,A)}},executeKeyFrame:function(x){var y=this._keyFrameObj[x];if(!y){return}this._baseFrame=y;for(var B in y){if(B=="transition"||B=="action"||B=="index"||B=="nextFrame"){continue}this._setProperty(this._target,B,y[B])}if(y.action&&y.action instanceof Function){y.action.apply(this._target)}if(y.transition&&!y.nextFrame){var A=x;while(A<=this._totalFrame){A++;if(this._keyFrameObj[A]){var z=this._keyFrameObj[A];for(var B in z){if(!y[B]){y[B]=this._getProperty(this._target,B)}}y.nextFrame=z;break}}}},setTotalFrames:function(x){this._totalFrame=x},getTotalFrames:function(x){return this._totalFrame},setFps:function(x){this._fps=x},getTarget:function(){return this._target},getFirstFrame:function(){return this._firstFrame},_getProperty:function(y,z){z.match(/^([a-z])(.*)/);var x="get"+RegExp.$1.toUpperCase()+RegExp.$2;if(y[x]){return y[x]()}return undefined},_setProperty:function(z,A,x){A.match(/^([a-z])(.*)/);var y="set"+RegExp.$1.toUpperCase()+RegExp.$2;if(z[y]){z[y](x)}}});i.KeyFrameAnimation=o.create(s,{_fps:0,_totalFrame:0,_timelineArr:null,_timer:null,_updateFunc:null,_shouldLoop:false,_currentFrame:1,initialize:function(B,z,x){this._fps=B;this._totalFrame=z;this._timer=new j();for(var y=0;y<x.length;y++){var A=x[y];if(A.constructor!=i.Timeline){throw new Error("set an instance of anim.Timeline")}A.setTotalFrames(z);A.setFps(this._fps)}this._timelineArr=(x)?x:[]},addTimeline:function(x){this._timelineArr.push(x)},play:function(x){this.gotoAndPlay(1,x)},stop:function(){var x=i.Animation.system;if(this._updateFunc){x.removeEventListener(v.ENTER_FRAME,this._updateFunc);this._updateFunc=null}this.dispatchEvent(v.COMPLETE)},gotoAndPlay:function(z,x){if(z>this._totalFrame){throw new Error("invalid frame index")}if(x){this._shouldLoop=x}this._updateFunc=w(this._update,this);this._currentFrame=z;this._executeKeyFrame(this._currentFrame);this._timer.start();var y=i.Animation.system;y.addEventListener(v.ENTER_FRAME,this._updateFunc)},_update:function(){var x=this._timer.getElapsed();var A=1000/this._fps;if(x>=A){this._step();x=this._timer.getElapsed()}for(var y=0;y<this._timelineArr.length;y++){var z=this._timelineArr[y];z.update(this._currentFrame,x)}},_step:function(){this._timer.reset();this._currentFrame++;this._executeKeyFrame(this._currentFrame);if(this._currentFrame==this._totalFrame){if(!this._shouldLoop){this.stop();return}this._currentFrame=0}},_executeKeyFrame:function(x){for(var y=0;y<this._timelineArr.length;y++){var z=this._timelineArr[y];z.executeKeyFrame(x)}},getCurrentFrame:function(){return this._currentFrame},getTotalFrame:function(){return this._totalFrame}});var r=o.create(s,(function(){var y=0,D=1;function z(){this._loadImgNum=0;this._loadedImgNum=0;this._imageHash={};this._loadingImgArr=[];this._srcArr=[]}function E(K){this._srcArr=K;this._loadedImgNum=0;this._loadImgNum=K.length;this._loadingImgArr=[];if(!K||K.length===0){this.dispatchEvent(v.COMPLETE);return}for(var J=0,H=this._srcArr.length;J<H;J++){var L=this._srcArr[J];var I;if(L.constructor==HTMLImageElement){I=L;if(I.complete){A.call(this,{target:I})}else{L.onload=w(A,this);L.onerror=w(B,this)}}else{if(L.constructor==String){I=document.createElement("img");I.src=L;I.onload=w(A,this);I.onerror=w(B,this);this._imageHash[L]=I}}this._loadingImgArr.push(I)}this._srcArr=[]}function A(I){var H;I.target.onload=null;I.target.onerror=null;this._loadedImgNum++;this.dispatchEvent(v.PROGRESS);if(this._loadedImgNum==this._loadImgNum){this.dispatchEvent(v.COMPLETE)}}function B(K){var J,H,I;for(J=0,H=this._loadingImgArr.length;J<H;J++){I=this._loadingImgArr[J];I.onload=null;I.onerror=null}this.dispatchEvent(v.ERROR);throw new Error("Load Error : "+K.target.src)}function C(){}function F(H,I){if(!this._imageHash[H]){return null}if(I&&I.length==4){return new k.Image(this._imageHash[H],I)}else{return new k.Image(this._imageHash[H])}}function x(){return this._loadImgNum}function G(){return this._loadedImgNum}return{initialize:z,load:E,getImage:F,getTotal:x,getLoaded:G}})());var b=o.create(s,{_originFps:0,_width:0,_height:0,_canvas:null,_context:null,_disableClearRect:false,_game:null,_gameClass:null,_gameParams:null,_intervalId:null,_stage:null,_imageManager:null,_realFps:0,_runTime:0,_runCount:0,_prevTime:0,_fpsElem:null,_maxFps:0,_adjustCount:1,_timer:null,_canvasScale:1,_ADJUST_FPS_TIME:10000,_ADJUST_FACTOR:2.5,initialize:function(z,x,A,y){this._width=z;this._height=x;this._canvas=document.getElementById(A);this._context=this._canvas.getContext("2d");this._stage=new k.Stage(z,x);this._timer=new j();this._disableClearRect=(y)?true:false;this._canvas.width=this._width;this._canvas.height=this._height;i.Animation.system=this;g.system=this;k.Image.context=this._context;arc._system=this;this._fpsElem=document.getElementById("fps");this._bindedRun=w(this.run,this);this._setEvent();this._setScroll()},setFullScreen:function(y,x){this._fullScreenMode=(y)?y:"width";this._shouldShrink=x;this._setViewport();if(m.isiOS){window.addEventListener("orientationchange",w(this._setViewport,this),true)}else{window.addEventListener("resize",w(this._setViewport,this),true)}},_setViewport:function(A){var y=window.innerWidth,x=window.innerHeight;if(!this._shouldShrink&&y<this._canvas.width){y=this._canvas.width}if(!this._shouldShrink&&x<this._canvas.height){x=this._canvas.height}var B=y/this._canvas.width,z=x/this._canvas.height;switch(this._fullScreenMode){case"width":this._canvasScale=B;break;case"height":this._canvasScale=z;break;case"all":this._canvasScale=(B<z)?B:z;break}this._canvas.style.width=Math.floor(this._canvas.width*this._canvasScale)+"px";this._canvas.style.height=Math.floor(this._canvas.height*this._canvasScale)+"px"},_setEvent:function(){var y=this,x={};function E(F){return{x:F.pageX/y._canvasScale-y._canvas.offsetLeft,y:F.pageY/y._canvasScale-y._canvas.offsetTop}}function D(G,H){if(!H.willPropagate()){return}var F=G.getParent();G.dispatchEvent(H);if(F){D(F,H)}}function B(G,F,M){var J=G._displayArr,H,L;for(var I=J.length-1;I>=0;I--){H=J[I];if(!H.getVisible()){continue}L=G.localToGlobal(H._screenRect[0],H._screenRect[1]);if(L[0]<=F&&L[0]+H._screenRect[2]>=F&&L[1]<=M&&L[1]+H._screenRect[3]>=M){if(H._displayArr){var K=B(H,F,M);if(K){return K}}else{return H}}}return null}function z(H){H.preventDefault();function I(M,O){var N=E(M),L=B(y._stage,N.x,N.y);if(!L){L=y._stage}x[O]=L;var K=new v(v.TOUCH_START,{x:N.x,y:N.y});D(L,K)}if(H.type=="mousedown"){window.addEventListener("mousemove",C,true);window.addEventListener("mouseup",A,true);I(H,0)}else{for(var G=0,F=H.changedTouches.length;G<F;G++){var J=H.changedTouches[G];I(J,J.identifier)}}}function C(H){H.preventDefault();function I(M,O){var L=x[O],N=E(M);if(L){var K=new v(v.TOUCH_MOVE,{x:N.x,y:N.y});D(L,K)}}if(H.type=="mousemove"){I(H,0)}else{for(var G=0,F=H.changedTouches.length;G<F;G++){var J=H.changedTouches[G];I(J,J.identifier)}}}function A(H){H.preventDefault();function I(M,O){var L=x[O],N=E(M);delete x[O];if(L){var K=new v(v.TOUCH_END,{x:N.x,y:N.y});D(L,K)}}if(H.type=="mouseup"){window.removeEventListener("mousemove",C,true);window.removeEventListener("mouseup",A,true);I(H,0)}else{for(var G=0,F=H.changedTouches.length;G<F;G++){var J=H.changedTouches[G];I(J,J.identifier)}}}if(m.isMobile){this._canvas.addEventListener("touchstart",z,true);this._canvas.addEventListener("touchmove",C,true);this._canvas.addEventListener("touchend",A,true)}else{this._canvas.addEventListener("mousedown",z,true)}},_setScroll:function(){function x(){if(window.pageYOffset<=1){setTimeout(w(function(){scrollTo(0,1);setTimeout(w(this._setViewport,this),1000)},this),10)}}if(d){window.addEventListener("load",w(x,this),false)}else{x.call(this)}},load:function(x){this._isStartedWithLoad=true;if(!this._imageManager){this._imageManager=new r()}this._imageManager.addEventListener(v.PROGRESS,w(this._loading,this));this._imageManager.addEventListener(v.COMPLETE,w(this._loaded,this));this._imageManager.load(x)},_loading:function(){this.dispatchEvent(v.PROGRESS,{total:this._imageManager.getTotal(),loaded:this._imageManager.getLoaded()})},_loaded:function(){this._imageManager.removeEventListener(v.PROGRESS);this._imageManager.removeEventListener(v.COMPLETE);this.dispatchEvent(v.COMPLETE);this._startGame()},setGameClass:function(x,y){this._gameClass=x;this._gameParams=y},start:function(){if(this._game||this._isStartedWithLoad){throw new Error("do not call System.start or System.load again")}this._startGame()},_startGame:function(){j.tick();this._game=new this._gameClass(this._gameParams,this);this._stage.addChild(this._game);this._prevTime=j.time;this._timer.start();this._intervalId=window.requestAnimationFrame(this._bindedRun)},stop:function(){window.cancelAnimationFrame(this._intervalId)},run:function(){j.tick();this._runTime+=(j.time-this._prevTime);this._runCount++;if(this._runTime>=1000){this._realFps=this._runCount*1000/this._runTime;this._runCount=this._runTime=0;if(this._fpsElem){this._fpsElem.innerHTML=this._realFps}if(this._realFps>this._maxFps){this._maxFps=this._realFps}}this._prevTime=j.time;if(!this._disableClearRect){this._context.clearRect(0,0,this._width,this._height)}this._game.update();this._stage.draw();this.dispatchEvent(v.ENTER_FRAME);this._intervalId=window.requestAnimationFrame(this._bindedRun)},getWidth:function(){return this._width},getHeight:function(){return this._height},getImage:function(x,y){return this._imageManager.getImage(x,y)},getCanvas:function(){return this._canvas},getStage:function(){return this._stage},getFps:function(){return this._realFps}});var c=o.create(k.DisplayObjectContainer,{_system:null,initialize:function(y,x){this._system=x},update:function(){}});var d=false;window.addEventListener("load",function(){d=true},false);h.arc={ua:m,display:k,anim:i,util:a,Class:o,Event:v,EventDispatcher:s,Timer:j,CountTimer:g,Ajax:n,ImageManager:r,System:b,Game:c}})(window);